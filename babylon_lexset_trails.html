<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">

    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
        <title>Niantic vs ADE20k, first 3 eigenvalues</title>

        <style>
            html, body {
                overflow: hidden;
                width: 100%;
                height: 100%;
                margin: 0;
                padding: 0;
            }

            #renderCanvas {
                width: 100%;
                height: 100%;
                touch-action: none;
            }
        </style>

        <script src="https://preview.babylonjs.com/babylon.js"></script>
        <script src="https://preview.babylonjs.com/loaders/babylonjs.loaders.min.js"></script>
        <script src="https://code.jquery.com/pep/0.4.3/pep.js"></script>
    </head>

   <body>

    <canvas id="renderCanvas" touch-action="none"></canvas> <!-- touch-action="none" for best results from PEP -->

    <script>
        var canvas = document.getElementById("renderCanvas"); // Get the canvas element
        var engine = new BABYLON.Engine(canvas, true); // Generate the BABYLON 3D engine

        /******* Add the create scene function ******/
      // https://doc.babylonjs.com/resources/external_pg_assets

      var createScene = function () {
	  var scene = new BABYLON.Scene(engine);

	  // Create camera and light
	  var light = new BABYLON.PointLight("Point", new BABYLON.Vector3(5, 10, 5), scene);
	  var camera = new BABYLON.ArcRotateCamera("Camera", 1, 0.8, 8, new BABYLON.Vector3(0, 0, 0), scene);
	  camera.attachControl(canvas, true);

	  var xp1 = [-1.22,-1.04,-1.01,-1.74,-1.93,-0.39,-1.17,-1.60,-1.42,-1.11,-1.36,-1.62,-0.95,-1.77,-1.15,-1.40,
			-1.73,-1.89,-2.00,-1.16,-1.40,-1.79,-1.42,-0.98,-1.26,-1.70,-1.75,-1.32,-1.34,-1.26,-1.13,-2.12,
			-1.09,-1.14,-1.02,-1.56,-1.40,-1.16,-1.61,-1.24,-1.28,-1.38,-1.23,-1.30,-2.22,-1.10,-1.42,-0.67,
			-1.31,-2.09,-0.69,-1.37,-1.39,-1.22,-1.78,-1.15,-0.98,-0.97,-1.06,-0.97,-0.85,-0.76,-1.30,-1.02,
			-1.74,-1.16,-1.00,-0.95,-1.56,-1.83,-2.03,-1.85,-1.12,-1.05,-1.83,-1.14,-1.43,-0.90,-0.81,-1.07,
			-1.28,-1.92,-0.63,-1.77,-1.42,-1.37,-1.34,-1.13,-1.97,-1.24,-1.23,-0.86,-1.20,-1.47,-0.75,-1.46,
			-1.62,-2.01,-1.49,-1.66,-1.36,-0.68,-1.74,-1.72,-1.81,-0.85,-1.56,-1.32,-1.95,-1.01,-1.28,-1.31,
			-1.34,-1.39,-1.63,-1.20,-0.99,-1.84,-1.74,-0.79,-1.32,-1.38,-1.82,-1.16,-1.38,-1.60,-1.59,-0.42,
			-0.53,-0.88,-1.77,-0.79,-1.84,-2.02,-0.94,-1.16,-1.48,-1.41,-1.28,-1.04,-1.08,-1.30,-1.24,-1.28,
			-1.15,-1.15,-1.69,-1.61,-1.74,-1.23,-1.15,-0.98,-1.63,-0.98,-1.13,-1.13,-1.13,-1.29,-1.22,-1.42,
			-0.93,-0.66,-1.91,-1.20,-1.16,-1.73,-1.77,-1.19,-1.42,-2.19,-0.82,-1.50,-1.98,-1.85,-1.01,-0.71,
			-0.90,-1.35,-0.98,-1.31,-1.43,-1.47,-1.24,-1.71,-1.56,-1.30,-1.12,-1.09,-0.79,-0.95,-1.16,-2.07,
			-1.00,-1.57,-1.91,-1.18,-0.97,-1.06,-1.50,-1.04,-0.67,-1.23,-1.69,-1.54,-1.54,-0.88,-1.59,-1.90,
			-1.23,-1.82,-1.50,-0.81,-1.39,-1.21,-1.74,-2.05,-0.98,-1.95,-0.72,-0.89,-0.69,-1.34,-1.58,-1.47,
			-1.08,-1.50,-1.05,-1.87,-1.89,-0.42,-1.00,-1.04,-1.65,-1.37,-1.65,-1.51,-2.05,-1.33,-1.07,-1.08,
			-1.19,-0.58,-1.98,-1.47,-1.04,-0.86,-1.04,-1.26,-1.91,-1.25,-1.21,-1.24,-1.37,-1.65,-0.68,-1.57];

	  var yp1 = [0.86,0.39,0.47,0.22,0.89,-0.00,0.82,0.21,0.40,0.70,-0.11,0.18,0.04,0.31,-0.18,-0.41,
			-0.04,0.13,0.29,0.46,0.59,0.09,0.35,0.54,0.85,0.58,0.35,0.58,1.17,0.22,0.28,1.59,
			0.11,0.68,0.13,-0.25,0.37,-0.05,-0.19,-0.06,-0.19,0.36,0.14,0.51,0.43,0.84,0.58,0.04,
			0.01,-0.05,0.27,1.05,-0.19,-0.60,0.86,0.55,-0.04,0.16,0.27,0.12,0.52,-0.12,0.14,-0.27,
			0.63,0.41,-0.10,0.35,-0.10,0.19,0.18,0.33,0.38,0.08,0.84,-0.09,-0.23,0.23,0.03,0.11,
			0.03,0.92,0.20,0.14,0.19,0.43,0.75,-0.34,0.66,0.47,0.73,0.32,-0.03,-0.40,0.13,0.28,
			0.18,0.07,0.33,0.15,0.14,0.76,-0.08,-0.05,0.15,0.39,0.24,-0.02,0.45,0.57,1.00,0.99,
			0.67,-0.21,-0.14,0.02,-0.27,0.27,-0.02,0.10,0.41,0.54,0.54,-0.14,-0.21,0.63,0.35,0.35,
			1.19,-0.12,0.07,-0.17,-0.14,0.87,0.17,0.10,0.00,0.36,-0.04,0.10,0.38,-0.19,0.86,-0.14,
			0.34,0.32,0.16,0.53,0.94,-0.13,0.29,0.10,0.07,0.08,0.10,-0.01,0.05,0.38,0.52,0.25,
			-0.37,0.50,-0.15,0.60,0.31,0.64,0.34,0.42,-0.31,0.15,-0.02,0.54,1.20,0.97,0.28,0.85,
			-0.03,0.14,-0.03,-0.12,0.65,0.81,0.06,-0.43,0.42,-0.08,0.56,0.08,0.30,0.38,0.42,0.61,
			0.46,0.43,0.73,0.55,-0.16,0.62,1.20,-0.03,0.32,0.11,0.18,1.25,0.46,0.30,0.13,0.50,
			0.31,0.02,-0.21,1.13,-0.21,0.97,0.97,0.85,0.14,0.20,0.65,-0.31,0.14,0.34,0.10,0.30,
			0.18,0.08,0.68,-0.05,1.49,0.55,0.31,0.25,1.14,0.21,0.28,0.55,-0.33,0.09,0.14,0.45,
			-0.22,0.18,0.76,0.98,0.33,0.67,-0.06,-0.15,0.19,0.03,0.19,0.13,0.20,0.29,0.46,0.02];

	  var zp1 = [0.12,-0.12,0.14,0.20,0.24,0.07,0.01,-0.07,0.29,-0.10,0.09,0.31,0.21,0.29,0.37,0.24,
			0.82,0.28,0.28,-0.03,0.02,0.53,0.62,0.33,0.38,0.06,0.23,-0.06,0.46,-0.20,0.17,0.46,
			0.39,0.16,0.45,0.50,0.47,-0.32,0.45,-0.14,0.33,0.08,-0.01,0.34,0.75,0.16,0.39,-0.10,
			0.55,0.31,0.40,0.24,0.26,0.25,0.44,0.49,0.19,0.20,0.19,0.35,0.56,0.54,-0.01,0.38,
			0.11,0.27,0.31,0.56,0.49,0.24,0.25,0.43,0.49,0.58,0.35,0.51,-0.13,-0.15,0.32,-0.33,
			0.09,0.36,0.24,0.17,0.15,0.78,0.18,0.12,0.44,0.04,0.18,0.09,0.30,0.53,-0.26,0.27,
			0.48,0.26,0.49,-0.04,0.79,0.05,0.55,0.50,0.43,0.13,0.25,0.38,0.11,0.36,0.06,0.21,
			0.41,0.53,0.53,0.10,0.22,0.24,0.36,0.30,0.20,0.72,0.58,0.31,0.25,-0.08,0.09,0.23,
			0.48,0.42,0.42,0.34,0.29,0.12,-0.12,0.33,0.44,0.50,0.18,0.19,0.42,0.40,0.28,0.25,
			0.25,0.57,0.54,-0.02,-0.23,-0.01,0.26,0.09,0.29,0.14,0.31,0.49,0.04,0.09,-0.25,-0.06,
			0.19,0.16,1.17,0.18,1.19,0.05,0.41,0.20,0.54,0.84,0.05,0.25,0.09,0.34,0.08,0.25,
			0.50,0.39,0.07,0.16,0.48,0.23,0.18,0.78,0.34,0.79,0.47,-0.00,0.02,-0.12,0.23,0.43,
			0.55,0.16,0.19,0.47,0.54,0.47,0.58,0.32,0.44,0.49,0.64,0.36,0.28,0.33,-0.05,0.08,
			-0.15,0.45,0.32,0.01,0.36,-0.11,0.22,0.30,0.45,0.71,0.50,0.19,0.19,-0.07,0.29,0.30,
			0.09,0.02,0.17,0.32,0.61,0.07,0.13,0.09,0.02,0.42,0.39,-0.19,0.52,0.40,0.36,-0.15,
			0.71,0.27,0.63,0.23,0.35,0.52,0.17,0.08,0.17,0.11,-0.19,0.23,0.26,0.35,0.10,-0.07];

	  var xp2 = [0.20,0.18,0.15,0.16,0.15,0.17,0.18,0.17,0.18,0.18,-0.59,-0.71,-0.70,-0.59,-0.46,-0.40,
			-0.15,-0.06,-0.01,-0.00,-1.03,-1.04,-1.02,-0.95,-0.86,-0.75,-0.70,-0.81,-1.02,-1.12,-0.39,-0.33,
			-0.31,-0.27,-0.34,-0.48,-0.60,-0.62,-0.60,-0.60,-1.34,-1.29,-1.23,-1.29,-1.34,-1.29,-1.20,-1.18,
			-1.17,-1.21,-1.05,-1.00,-0.79,-0.74,-0.74,-0.82,-0.92,-0.89,-0.94,-1.05,-0.45,-0.44,-0.40,-0.41,
			-0.39,-0.39,-0.46,-0.55,-0.61,-0.68,-0.75,-0.59,-0.56,-0.61,-0.72,-0.80,-0.79,-0.66,-0.51,-0.32,
			-0.52,-0.49,-0.45,-0.41,-0.39,-0.38,-0.37,-0.35,-0.35,-0.34,-0.73,-0.72,-0.74,-0.73,-0.70,-0.67,
			-0.63,-0.60,-0.60,-0.61,0.20,0.18,0.15,0.16,0.15,0.17,0.18,0.17,0.18,0.18,-0.59,-0.71,
			-0.70,-0.59,-0.46,-0.40,-0.15,-0.06,-0.01,-0.00,-1.03,-1.04,-1.02,-0.95,-0.86,-0.75,-0.70,-0.81,
			-1.02,-1.12,-0.39,-0.33,-0.31,-0.27,-0.34,-0.48,-0.60,-0.62,-0.60,-0.60,-1.34,-1.29,-1.23,-1.29,
			-1.34,-1.29,-1.20,-1.18,-1.17,-1.21,-1.05,-1.00,-0.79,-0.74,-0.74,-0.82,-0.92,-0.89,-0.94,-1.05,
			-0.45,-0.44,-0.40,-0.41,-0.39,-0.39,-0.46,-0.55,-0.61,-0.68,-0.75,-0.59,-0.56,-0.61,-0.72,-0.80,
			-0.79,-0.66,-0.51,-0.32,-0.52,-0.49,-0.45,-0.41,-0.39,-0.38,-0.37,-0.35,-0.35,-0.34,-0.73,-0.72,
			-0.74,-0.73,-0.70,-0.67,-0.63,-0.60,-0.60,-0.61,0.20,0.18,0.15,0.16,0.15,0.17,0.18,0.17,
			0.18,0.18,-0.59,-0.71,-0.70,-0.59,-0.46,-0.40,-0.15,-0.06,-0.01,-0.00,-1.03,-1.04,-1.02,-0.95,
			-0.86,-0.75,-0.70,-0.81,-1.02,-1.12,-0.39,-0.33,-0.31,-0.27,-0.34,-0.48,-0.60,-0.62,-0.60,-0.60,
			-1.34,-1.29,-1.23,-1.29,-1.34,-1.29,-1.20,-1.18,-1.17,-1.21,-1.05,-1.00,-0.79,-0.74,-0.74,-0.82];

	  var yp2 = [0.68,0.61,0.59,0.58,0.53,0.58,0.58,0.56,0.56,0.58,-0.01,-0.13,-0.13,-0.15,-0.05,-0.07,
			-0.03,0.06,0.14,0.13,-0.36,-0.40,-0.45,-0.44,-0.41,-0.39,-0.37,-0.38,-0.36,-0.27,-0.24,-0.13,
			-0.10,-0.07,-0.09,-0.03,0.07,0.10,0.11,0.08,-0.45,-0.42,-0.41,-0.46,-0.48,-0.48,-0.48,-0.49,
			-0.53,-0.55,-0.29,-0.32,-0.20,-0.20,-0.22,-0.25,-0.22,-0.15,-0.11,-0.05,-0.09,-0.08,-0.08,-0.09,
			-0.08,-0.07,-0.10,-0.10,-0.07,-0.05,0.49,0.53,0.59,0.61,0.57,0.45,0.33,0.33,0.34,0.36,
			-0.08,-0.07,-0.06,-0.05,-0.06,-0.07,-0.09,-0.07,-0.05,-0.05,-0.20,-0.27,-0.36,-0.38,-0.39,-0.36,
			-0.34,-0.32,-0.30,-0.30,0.68,0.61,0.59,0.58,0.53,0.58,0.58,0.56,0.56,0.58,-0.01,-0.13,
			-0.13,-0.15,-0.05,-0.07,-0.03,0.06,0.14,0.13,-0.36,-0.40,-0.45,-0.44,-0.41,-0.39,-0.37,-0.38,
			-0.36,-0.27,-0.24,-0.13,-0.10,-0.07,-0.09,-0.03,0.07,0.10,0.11,0.08,-0.45,-0.42,-0.41,-0.46,
			-0.48,-0.48,-0.48,-0.49,-0.53,-0.55,-0.29,-0.32,-0.20,-0.20,-0.22,-0.25,-0.22,-0.15,-0.11,-0.05,
			-0.09,-0.08,-0.08,-0.09,-0.08,-0.07,-0.10,-0.10,-0.07,-0.05,0.49,0.53,0.59,0.61,0.57,0.45,
			0.33,0.33,0.34,0.36,-0.08,-0.07,-0.06,-0.05,-0.06,-0.07,-0.09,-0.07,-0.05,-0.05,-0.20,-0.27,
			-0.36,-0.38,-0.39,-0.36,-0.34,-0.32,-0.30,-0.30,0.68,0.61,0.59,0.58,0.53,0.58,0.58,0.56,
			0.56,0.58,-0.01,-0.13,-0.13,-0.15,-0.05,-0.07,-0.03,0.06,0.14,0.13,-0.36,-0.40,-0.45,-0.44,
			-0.41,-0.39,-0.37,-0.38,-0.36,-0.27,-0.24,-0.13,-0.10,-0.07,-0.09,-0.03,0.07,0.10,0.11,0.08,
			-0.45,-0.42,-0.41,-0.46,-0.48,-0.48,-0.48,-0.49,-0.53,-0.55,-0.29,-0.32,-0.20,-0.20,-0.22,-0.25];

	  var zp2 = [0.18,0.10,0.10,0.16,0.24,0.26,0.28,0.32,0.31,0.28,-0.08,0.03,0.04,0.22,0.08,0.06,
			0.08,0.01,0.00,0.07,0.43,0.49,0.55,0.57,0.53,0.49,0.48,0.58,0.64,0.69,0.35,0.22,
			0.21,0.18,0.17,0.28,0.35,0.39,0.31,0.26,0.44,0.36,0.42,0.52,0.52,0.52,0.49,0.45,
			0.43,0.40,0.66,0.69,0.72,0.68,0.63,0.70,0.71,0.63,0.71,0.71,0.22,0.22,0.22,0.23,
			0.23,0.25,0.35,0.39,0.39,0.38,0.85,0.55,0.63,0.75,0.94,1.25,1.52,1.56,1.50,1.30,
			0.27,0.26,0.22,0.18,0.15,0.16,0.19,0.17,0.15,0.15,0.32,0.37,0.44,0.46,0.47,0.45,
			0.41,0.37,0.33,0.32,0.18,0.10,0.10,0.16,0.24,0.26,0.28,0.32,0.31,0.28,-0.08,0.03,
			0.04,0.22,0.08,0.06,0.08,0.01,0.00,0.07,0.43,0.49,0.55,0.57,0.53,0.49,0.48,0.58,
			0.64,0.69,0.35,0.22,0.21,0.18,0.17,0.28,0.35,0.39,0.31,0.26,0.44,0.36,0.42,0.52,
			0.52,0.52,0.49,0.45,0.43,0.40,0.66,0.69,0.72,0.68,0.63,0.70,0.71,0.63,0.71,0.71,
			0.22,0.22,0.22,0.23,0.23,0.25,0.35,0.39,0.39,0.38,0.85,0.55,0.63,0.75,0.94,1.25,
			1.52,1.56,1.50,1.30,0.27,0.26,0.22,0.18,0.15,0.16,0.19,0.17,0.15,0.15,0.32,0.37,
			0.44,0.46,0.47,0.45,0.41,0.37,0.33,0.32,0.18,0.10,0.10,0.16,0.24,0.26,0.28,0.32,
			0.31,0.28,-0.08,0.03,0.04,0.22,0.08,0.06,0.08,0.01,0.00,0.07,0.43,0.49,0.55,0.57,
			0.53,0.49,0.48,0.58,0.64,0.69,0.35,0.22,0.21,0.18,0.17,0.28,0.35,0.39,0.31,0.26,
			0.44,0.36,0.42,0.52,0.52,0.52,0.49,0.45,0.43,0.40,0.66,0.69,0.72,0.68,0.63,0.70];



	  var scale = 50;
	  var offX = -1.33;
	  var offY = 0.28;
	  var offZ = 0.27;

	  var n_images = 256;

	  //--- Instantiate dataset cloud
	  var dataset1 = new BABYLON.SpriteManager("dataset1Manager", "https://raw.githubusercontent.com/miguel-aragon/SDSS_fits_cutout/master/ADE20k_16x16_green_trails.jpg", n_images, 64, scene);
	  //--- Specity properties for each tile
	  for (var i = 0; i < n_images; i++) {
	      var tree = new BABYLON.Sprite("tree", dataset1);
	      tree.width = 2;
	      tree.height = 2;
	      tree.position.x = (xp1[i]-offX)*scale;
	      tree.position.y = (yp1[i]-offY)*scale;
	      tree.position.z = (zp1[i]-offZ)*scale;
	      tree.cellIndex = i;
	      tree.uniqueId = i;
	      tree.isPickable = true;
	  }
	  dataset1.isPickable = true;

	  //--- Instantiate dataset cloud
	  var dataset1 = new BABYLON.SpriteManager("dataset2Manager", "https://raw.githubusercontent.com/miguel-aragon/SDSS_fits_cutout/master/Niantic_16x16_red_trails.jpg", n_images, 64, scene);
	  //--- Specity properties for each tile
	  for (var i = 0; i < n_images; i++) {
	      var tree = new BABYLON.Sprite("tree", dataset1);
	      tree.width = 2;
	      tree.height = 2;
	      tree.position.x = xp2[i]*scale - offX;
	      tree.position.y = yp2[i]*scale - offY;
	      tree.position.z = zp2[i]*scale - offZ;
	      tree.cellIndex = i;
	      tree.uniqueId = i;
	      tree.isPickable = true;
	  }
	  dataset1.isPickable = true;

	  scene.onPointerDown = function (evt) {
	      var pickResult = scene.pickSprite(this.pointerX, this.pointerY);
	      if (pickResult.hit) {
		  //pickResult.pickedSprite.angle += 0.5;
		  console.log(pickResult.pickedSprite.uniqueId);
	      }
	  };




	  // show axis
	  var showAxis = function(size) {
	      var makeTextPlane = function(text, color, size) {
		  var dynamicTexture = new BABYLON.DynamicTexture("DynamicTexture", 50, scene, true);
		  dynamicTexture.hasAlpha = true;
		  dynamicTexture.drawText(text, 5, 40, "bold 36px Arial", color , "transparent", true);
		  var plane = new BABYLON.Mesh.CreatePlane("TextPlane", size, scene, true);
		  plane.material = new BABYLON.StandardMaterial("TextPlaneMaterial", scene);
		  plane.material.backFaceCulling = false;
		  plane.material.specularColor = new BABYLON.Color3(0, 0, 0);
		  plane.material.diffuseTexture = dynamicTexture;
		  return plane;
	      };

	      var axisX = BABYLON.Mesh.CreateLines("axisX", [
		  new BABYLON.Vector3.Zero(), new BABYLON.Vector3(size, 0, 0), new BABYLON.Vector3(size * 0.95, 0.05 * size, 0),
		  new BABYLON.Vector3(size, 0, 0), new BABYLON.Vector3(size * 0.95, -0.05 * size, 0)
	      ], scene);
	      axisX.color = new BABYLON.Color3(1, 0, 0);
	      var xChar = makeTextPlane("V1", "red", size / 10);
	      xChar.position = new BABYLON.Vector3(0.9 * size, -0.05 * size, 0);
	      var axisY = BABYLON.Mesh.CreateLines("axisY", [
		  new BABYLON.Vector3.Zero(), new BABYLON.Vector3(0, size, 0), new BABYLON.Vector3( -0.05 * size, size * 0.95, 0),
		  new BABYLON.Vector3(0, size, 0), new BABYLON.Vector3( 0.05 * size, size * 0.95, 0)
	      ], scene);
	      axisY.color = new BABYLON.Color3(0, 1, 0);
	      var yChar = makeTextPlane("V2", "green", size / 10);
	      yChar.position = new BABYLON.Vector3(0, 0.9 * size, -0.05 * size);
	      var axisZ = BABYLON.Mesh.CreateLines("axisZ", [
		  new BABYLON.Vector3.Zero(), new BABYLON.Vector3(0, 0, size), new BABYLON.Vector3( 0 , -0.05 * size, size * 0.95),
		  new BABYLON.Vector3(0, 0, size), new BABYLON.Vector3( 0, 0.05 * size, size * 0.95)
	      ], scene);
	      axisZ.color = new BABYLON.Color3(0, 0, 1);
	      var zChar = makeTextPlane("V3", "blue", size / 10);
	      zChar.position = new BABYLON.Vector3(0, 0.05 * size, 0.9 * size);
	  };

	  showAxis(50);



	  return scene;
      };
      /******* End of the create scene function ******/

        var scene = createScene(); //Call the createScene function

        // Register a render loop to repeatedly render the scene
        engine.runRenderLoop(function () {
                scene.render();
        });

        // Watch for browser/canvas resize events
        window.addEventListener("resize", function () {
                engine.resize();
        });
    </script>

   </body>

</html>
